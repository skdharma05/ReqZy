<div class="pr-detail">
  <!-- Page Header -->
  <div class="page-header">
    <div class="header-content">
      <div class="header-left">
        <button class="back-btn" (click)="onBack()">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
          </svg>
          Back to Requests
        </button>
        <h1 class="page-title">Purchase Request Details</h1>
      </div>
      <div class="header-actions">
        @if (pr() && canEdit()) {
          <button class="btn btn-primary" (click)="onEdit()">
            <svg class="btn-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
            </svg>
            Edit Request
          </button>
        }
      </div>
    </div>
  </div>

  <!-- Loading State -->
  @if (isLoading()) {
    <div class="loading-container">
      <div class="loading-spinner"></div>
      <p class="loading-text">Loading purchase request details...</p>
    </div>
  }

  <!-- Error State -->
  @else if (error()) {
    <div class="error-container">
      <div class="error-icon">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
      </div>
      <h3 class="error-title">Error Loading Request</h3>
      <p class="error-message">{{ error() }}</p>
      <button class="btn btn-secondary" (click)="onBack()">
        Go Back
      </button>
    </div>
  }

  <!-- PR Details -->
  @else if (pr()) {
    <div class="pr-content">
      <!-- Status and Basic Info Card -->
      <div class="info-card">
        <div class="card-header">
          <h2 class="card-title">Request Information</h2>
          <span class="status-badge" [class]="getStatusClass(pr()!.status)">
            {{ pr()!.status | titlecase }}
          </span>
        </div>
        <div class="card-content">
          <div class="info-grid">
            <div class="info-item">
              <label class="info-label">Request ID</label>
              <span class="info-value">{{ pr()!.id }}</span>
            </div>
            <div class="info-item">
              <label class="info-label">Item</label>
              <span class="info-value">{{ pr()!.item }}</span>
            </div>
            <div class="info-item">
              <label class="info-label">Quantity</label>
              <span class="info-value">{{ pr()!.quantity }}</span>
            </div>
            <div class="info-item">
              <label class="info-label">Unit Price</label>
              <span class="info-value">{{ formatCurrency(calculateUnitPrice()) }}</span>
            </div>
            <div class="info-item">
              <label class="info-label">Total Value</label>
              <span class="info-value total-value">{{ formatCurrency(pr()!.totalValue) }}</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Request Details Card -->
      <div class="info-card">
        <div class="card-header">
          <h2 class="card-title">Request Details</h2>
        </div>
        <div class="card-content">
          <div class="info-grid">
            <div class="info-item">
              <label class="info-label">Created By</label>
              <span class="info-value">{{ pr()!.creator?.email || 'Unknown' }}</span>
            </div>
            <div class="info-item">
              <label class="info-label">Department</label>
              <span class="info-value">{{ pr()!.department?.name || 'Unknown' }}</span>
            </div>
            <div class="info-item">
              <label class="info-label">Category</label>
              <span class="info-value">{{ pr()!.category?.name || 'Unknown' }}</span>
            </div>
            <div class="info-item">
              <label class="info-label">Created Date</label>
              <span class="info-value">{{ formatDate(pr()!.createdAt) }}</span>
            </div>
            <div class="info-item">
              <label class="info-label">Last Updated</label>
              <span class="info-value">{{ formatDate(pr()!.updatedAt) }}</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Approval Actions (if applicable) -->
      @if (canApprove()) {
        <div class="info-card approval-actions">
          <div class="card-header">
            <h2 class="card-title">Approval Actions</h2>
          </div>
          <div class="card-content">
            <div class="approval-buttons">
              <button class="btn btn-success">
                <svg class="btn-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                Approve Request
              </button>
              <button class="btn btn-danger">
                <svg class="btn-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
                Reject Request
              </button>
            </div>
          </div>
        </div>
      }
    </div>
  }
</div>
